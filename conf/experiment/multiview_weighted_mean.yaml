name: "multiview/weighted_mean"
classification: True
multilabel: False
dataset:
  name: "multiview"
  path: "${data_dir}/multiview3D"
  args: {}
  modalities: 3
  batch_size: ${batch_size}
  num_classes: 2
  class_names: [
                bottle,
                cup
                ]
encoders:
  image1: 
      type: "ImageEncoder"
      args:
        in_channels: 3
        img_embed_pool_type: "avg"
        num_image_embeds: 1
        
  image2: 
      type: "ImageEncoder"
      args:
        in_channels: 3
        img_embed_pool_type: "avg"
        num_image_embeds: 1

  image3: 
      type: "ImageEncoder"
      args:
        in_channels: 3
        img_embed_pool_type: "avg"
        num_image_embeds: 1
        


predictors:
  image1: 
      type: "Classifier"
      args:
        in_dim: 2048
        out_dim: ${experiment.dataset.num_classes}
        n_layers: 0
        n_hidden: 512
        
  image2:
      type: "Classifier"
      args:
        in_dim: 2048
        out_dim: ${experiment.dataset.num_classes}
        n_layers: 0
        n_hidden: 512

  image3:
      type: "Classifier"
      args:
        in_dim: 2048
        out_dim: ${experiment.dataset.num_classes}
        n_layers: 0
        n_hidden: 512



head:
  type: "WeightedMean"
  threshold_input: False
  args: 
    weight_dims: [1, 3, 1]
    normalize_dim: 1
